## 项目名称
IslaBooks（AI 驱动的电子书阅读应用）

## 一句话愿景
把每本书变成一位可对话的导师：获取、阅读、理解与交流，一站式完成。

## 项目背景与目标
- 解决电子书阅读的“获取难、读不懂、读不完、记不住、无人交流”的痛点。
- 以用户本地导入为唯一书源；不提供任何外部下载/聚合功能；结合 AI 实时摘要、对话式理解、个性化推荐与社区互动，提升阅读效率与乐趣。
- 兼顾严肃阅读与轻阅读场景，同时支持多语言与移动端友好体验。同时支持iPad和iPhone。
- 作为个人开发者，暂无图书版权；应用不提供外部书源获取；用户通过本地文件导入方式使用合规内容。

## 目标用户与角色
- 学习型读者：需要高效理解与总结书本知识。
- 轻阅读用户：希望获得书单推荐和快速阅读。


## 用户故事（按角色细化）
### 学习型读者
- 作为学习型读者，我可以从本地或“文件”App 导入 ePub/纯文本书籍，便于精准获取学习材料。
- 作为学习型读者，我首次打开书籍即可看到 AI 导读摘要（核心观点、章节结构、关键术语），帮助我建立知识框架。
- 作为学习型读者，我在阅读中选中任意段落，可以直接请求翻译、术语解释、示例说明或对比概念，并附带原文引用与章节位置。
- 作为学习型读者，我可以对当前章节/整本书进行问答，获得含引用的严谨回答，并可多轮追问。
- 作为学习型读者，我在打开新书时会得到 3-5 道理解诊断题，答题后系统给出解析与后续学习建议。
- 作为学习型读者，我的高亮、笔记可一键生成“知识点卡片”，支持复习与检索。
- 作为学习型读者，我可以创建生词本/术语表，由 AI 自动补充定义与例句。
- 作为学习型读者，我的阅读进度、书签、划线与笔记在多设备间自动同步（iCloud），可选择仅本地保存。
- 作为学习型读者，我可以导出笔记/卡片为 Markdown/CSV，以便在外部工具复盘。（可选，若推出macOS版本软件）

### 轻阅读用户
- 作为轻阅读用户，我可以浏览 AI 推荐书单（每日精选、热门趋势、主题合集），并一键加入书架。
- 作为轻阅读用户，我打开书时可切换“快速摘要模式”，用 1 分钟了解大意与看点。
- 作为轻阅读用户，我可以向 AI 提问“这章讲了什么”“有没有更轻松的书”，获得精炼回答与替代推荐。
- 作为轻阅读用户，我可以查看他人书评/短评与高赞摘录，并收藏或分享片段。
- 作为轻阅读用户，我可以将喜欢的段落生成分享卡片（含引用），便于社交分享。
- 作为轻阅读用户，我的阅读进度自动保存，并可设置阅读提醒（每日/每周目标）。
- 作为轻阅读用户，我可以调整字体、行距与夜间模式，获得舒适的阅读体验。

## 关键功能清单
- 本地导入：从“文件”App/iCloud Drive/本机导入 ePub/纯文本并解析。
- AI 摘要：打开书籍时即时生成章节/全书摘要，支持缓存与更新。
- 阅读器：目录、书签、进度、划线与注释、全文检索、主题与排版设置、夜间模式、离线缓存。
- AI 对话：选区问答与整章/整书上下文问答；翻译、解释、总结、观点；引用原文与页码位置。
- AI 推荐：基于兴趣、行为与主题的个性化书单；支持冷启动策略与热门趋势。
- 社区与阅读任务：发布书单、感想与短评；发起阅读挑战/打卡；评论、点赞、关注与收藏。
- 理解诊断与学习建议：打开书籍时自动生成测验（选择/问答），即时反馈与后续学习建议。
- 账号与同步：使用 iCloud/CloudKit，无应用内注册；跨设备同步；隐私控制与仅本地保存。

## 功能说明与验收标准
- 本地导入
  - 功能：从本地或“文件”App 选择 ePub/纯文本文件导入到书架并解析渲染。
  - 验收：成功选择文件后可加入书架；在阅读器中正常渲染目录与正文。
- AI 摘要
  - 功能：首次打开书籍生成导读摘要；支持章节级摘要与全文级综述；可手动刷新。
  - 验收：摘要在5秒内开始流式输出；摘要含要点与目录映射；缓存命中可秒开。
- 阅读器
  - 功能：目录跳转、页内搜索、书签、划线、注释、进度同步、主题/字体/行距/夜间模式、离线阅读。
  - 验收：基础操作无明显卡顿（>60fps）；离线后可阅读已缓存书籍与笔记。
- AI 对话（阅读助手）
  - 功能：对选区/当前章节/全书进行翻译、解释、总结、观点回答；附引用出处；支持继续追问与多轮上下文。
  - 验收：选区问答在3秒内开始流式响应；回答含至少一个引用；可切换“更严谨/更简洁”模式。
- AI 推荐
  - 功能：基于阅读历史、偏好标签、停留时长等行为构建画像；提供每日/每周推荐书单与主题合集。
  - 验收：冷启动时提供通用优质榜单；使用3天后推荐点击率提升。
- 社区与阅读任务
  - 功能：创建书单（公开/私密）、发布感想/短评、发起挑战/打卡、评论与互动。
  - 验收：书单支持多书聚合与简单排序；任务页展示参与人数与完成率；评论实时可见。
- 理解诊断与建议
  - 功能：自动生成理解测验（2-5题起步），即时评分与解析；给出后续阅读路径或辅助资料建议。
  - 验收：题目覆盖书籍主要概念；答案含引用原文段落；建议可一键加入“学习计划”。
- 账号与同步
  - 功能：使用 iCloud/CloudKit 自动同步；无应用内注册；支持导入/导出与仅本地保存；提供云数据删除入口。
  - 验收：同一 Apple ID 设备间进度/书签/笔记一致；可在设置中关闭 iCloud 同步并保留本地；可一键清空 CloudKit 私有数据。

## 交互与信息架构
- 导航结构：发现（推荐/榜单/主题）— 阅读（我的书架/进度）— 社区（书单/任务/动态）— 我的（账号/设置）
- 阅读器交互
  - 选区浮层：翻译/解释/总结/提问/高亮/做题
  - 侧边栏：AI 聊天、参考文献、知识点卡片、章节大纲
  - 页眉：标题、目录、搜索、显示设置、同步状态
- AI 会话设计
  - 模式：选区问答、章节问答、跨书问答
  - 上下文：RAG 检索（章节/段落向量索引）、可调节“引用数量/严谨度”
  - 可视化：答案内联引用，点击可定位原文；支持导出为笔记卡片

## 非功能性需求
- 性能
  - 打开本地已缓存书籍：<2秒；首次解析 ePub：<5秒
  - AI 摘要/问答：<5秒开始流式输出；P95 <10秒完成
- 稳定性与容错
  - 网络失败自动重试；AI 超时降级到简要回答或延迟生成
- 隐私与安全
  - 最小化采集；用户可导出与删除数据；AI 请求脱敏；遵守版权与来源标注
- 成本与速率
  - 配额与熔断；请求合并与缓存；可选开源/商业模型；显式成本提示
- 可用性与可访问性
  - 夜间/高对比度；键盘与屏幕阅读器支持；移动端优先
- 国际化
  - 多语言 UI；跨语言书籍与翻译

## AI 设计与实现要点
- 模型与能力
  - 基础对话/摘要：通用大模型；翻译：强多语模型；嵌入：向量模型
- 提示工程
  - 结构化输出（要点、关键概念、术语表）；显式要求引用原文与章节位置
- 检索增强（RAG）
  - 章节切分、段落向量索引；优先使用本地检索结果；召回失败时再全局检索
- 流式与思考链
  - 采用流式输出；在摘要/解释时启用简化思考链，控制成本与时延
- 幻觉与安全
  - 引用强制；未命中原文时标示“推断”；敏感请求加防护与拒绝策略

## 数据来源与版权
- 书源：用户本地导入（应用不提供外部下载或抓取）
- 版权：用户对导入内容负责；应用提供版权提示；社区内容遵循用户协议

## 技术架构概览（初稿）
- 客户端：iOS/iPadOS（首发）
- 服务端：AI 网关、检索服务（向量库）、推荐服务、社区与任务服务（无内容抓取/下载）
- 存储：关系型数据库（核心业务）、本地文件存储（书文件与封面缓存）、向量数据库（段落索引）、缓存（会话/摘要缓存）
- 数据同步（用户数据）：iCloud/CloudKit（私有数据库），无应用内注册；可关闭与删除云数据
- 实时交互：WebSocket/Server-Sent Events 用于流式与实时互动

## 数据模型草案（简化）
- User（本地设置）：id，settings（不采集邮箱）；iCloud 用于标识同步，不存储个人标识
- Book：id，title，authors，language，source（固定为 local），metadata
- BookFile：id，bookId，format，uri，checksum
- LibraryItem：userId，bookId，status（在读/已读/想读），tags
- ReadingProgress：userId，bookId，location，updatedAt
- Highlight：id，userId，bookId，range，note，createdAt
- Annotation：id，userId，bookId，content，range，createdAt
- Post：id，authorId，type（review/note），content，bookRefs，createdAt
- ReadingList：id，ownerId，title，desc，bookIds，visibility
- Task/Challenge：id，title，rules，deadline，participants
- Quiz：id，bookId，userId，questions[]，createdAt
- RecommendationEvent：userId，bookId，eventType，timestamp

## API 草案（选摘）
- Import：本地文件导入（无服务端 API）
- Reader：/progress，/highlights，/annotations
- AI：
  - /ai/summary（bookId|chapterId）
  - /ai/qa（scope: selection|chapter|book，text|range）
  - /ai/quiz/generate（bookId）
- Recommend：/feed，/lists，/trending
- Community：/posts，/lists，/tasks
- Analytics：/events（阅读/AI/交互）

## 里程碑与范围
- v0.1 MVP
  - 本地文件导入、ePub 渲染、阅读器基础（目录/书签/进度/主题）
  - 打开书籍的 AI 导读摘要（缓存）、选区问答（翻译/解释/总结+引用）
  - iCloud 最小同步（进度）；离线缓存；无应用内注册
- v0.2
  - 个性化推荐书单、社区书单与基础互动、iCloud 完整同步（进度/书签/划线/笔记）
- v0.3
  - 理解诊断测验与学习建议、挑战/打卡、统计面板
- v1.0
  - 性能与稳定性优化、移动端发布、合规与成本治理完善

## 成功指标（示例）
- 次日/7日留存、平均阅读时长、单次会话 AI 问答量
- 推荐点击率/添加到书架率、测验完成率与正确率、社区活跃度
- AI 请求成功率与平均首字延迟、成本/DAU

## 风险与对策
- 版权与合规：严格限定公共领域内容与标注来源；审核与举报机制。
- AI 幻觉：引用强制、未命中提示、RAG 优先、本地检索优先。
- 成本与速率：缓存、批量/合并、异步/延迟生成、用户配额与开关。
- 复杂度与体验：分阶段发布、优先核心路径（获取-阅读-理解）。

## 开放问题
- 是否支持 PDF/扫描版与 OCR？优先度？
- 推荐是否引入协同过滤与社交关系？
- 社区内容的审核与分发机制？
- 是否提供付费订阅（高级模型、更多配额）？
- 教育场景下的班级/作业管理要不要纳入 v1.0？

## 术语表
- 选区问答：基于用户高亮/选择的片段进行上下文问答。
- RAG：检索增强生成，通过向量检索将原文片段注入提示。
- 引用：回答中给出的原文出处标注（章节/段落/位置）。

——

如果你认可本草案，我可以：
- 生成一份“产品需求文档（PRD）”与“技术设计文档（TDD）”的分拆版本；
- 按 v0.1 MVP 细化任务清单与验收用例；
- 在仓库创建 `docs/requirements.md` 并落地为版本化文档。